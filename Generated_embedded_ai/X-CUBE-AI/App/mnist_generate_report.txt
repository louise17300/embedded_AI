Neural Network Tools for STM32AI v1.6.0 (STM.ai v7.2.0-RC5)
Created date          : 2022-09-21 08:56:37
Parameters            : generate --name mnist -m D:/Data/Documents/Cours/ISMIN/3A/GP-COMPETENCIES-Embedded Systems/Conception_systeme/Embedded_IA_on_MCU/CNN_C2_16_10-20220920/MNIST_NN_C2_16_10.h5 --type keras --compression none --verbosity 1 --workspace C:\Users\arsen\AppData\Local\Temp\mxAI_workspace805111797122003635243303803991971 --output C:\Users\arsen\.stm32cubemx\mnist_output --allocate-inputs --allocate-outputs

Exec/report summary (generate)
------------------------------------------------------------------------------------------------------------------------
model file            : D:\Data\Documents\Cours\ISMIN\3A\GP-COMPETENCIES-Embedded Systems\Conception_systeme\Embedded_IA_on_MCU\CNN_C2_16_10-20220920\MNIST_NN_C2_16_10.h5
type                  : keras
c_name                : mnist
compression           : none
allocator strategy    : ['allocate-inputs', 'allocate-outputs']
workspace dir         : C:\Users\arsen\AppData\Local\Temp\mxAI_workspace805111797122003635243303803991971
output dir            : C:\Users\arsen\.stm32cubemx\mnist_output
model_name            : MNIST_NN_C2_16_10
model_hash            : 614db2b723ed95038e3cd1bc781e5515
input 1/1             : 'input_0'
                        784 items, 3.06 KiB, ai_float, float, (1,28,28,1), domain:activations/**default**
output 1/1            : 'dense_1'
                        10 items, 40 B, ai_float, float, (1,1,1,10), domain:activations/**default**
params #              : 6,478 items (25.30 KiB)
macc                  : 23,874
weights (ro)          : 25,912 B (25.30 KiB) (1 segment)
activations (rw)      : 3,832 B (3.74 KiB) (1 segment) *
ram (total)           : 3,832 B (3.74 KiB) = 3,832 + 0 + 0

(*) input/output buffers can be used from the activations buffer

Model name - MNIST_NN_C2_16_10 ['input_0'] ['dense_1']
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
id   layer (type,original)                oshape                   param/size     macc     connected to    |   c_size         c_macc              c_type                     
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
0    input_0 (Input, None)                [b:None,h:28,w:28,c:1]                                           |                                     
     conv2d_conv2d (Conv2D, Conv2D)       [b:None,h:28,w:28,c:2]   20/80          14,114   input_0         |   -80(-100.0%)   -14,114(-100.0%)   
     conv2d (Nonlinearity, Conv2D)        [b:None,h:28,w:28,c:2]                  1,568    conv2d_conv2d   |                  -1,568(-100.0%)    
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1    max_pooling2d (Pool, MaxPooling2D)   [b:None,h:14,w:14,c:2]                  1,568    conv2d          |   +80(+100.0%)   +15,682(+1000.1%)   optimized_conv2d_of32[0]   
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
2    flatten (Reshape, Flatten)           [b:None,c:392]                                   max_pooling2d   |                                     
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
3    dense_dense (Dense, Dense)           [b:None,c:16]            6,288/25,152   6,288    flatten         |                  +16(+0.3%)          dense_of32/nl_of32[1, 2]   
     dense (Nonlinearity, Dense)          [b:None,c:16]                           16       dense_dense     |                  -16(-100.0%)       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
4    dense_1_dense (Dense, Dense)         [b:None,c:10]            170/680        170      dense           |                  +150(+88.2%)        dense_of32/nl_of32[o][3, 4]
     dense_1 (Nonlinearity, Dense)        [b:None,c:10]                           150      dense_1_dense   |                  -150(-100.0%)      
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
model/c-model: macc=23,874/23,874  weights=25,912/25,912  activations=--/3,832 io=--/0



Generated C-graph summary
------------------------------------------------------------------------------------------------------------------------
model name            : mnist_nn_c2_16_10
c-name                : mnist
c-node #              : 5
c-array #             : 13
activations size      : 3832 (1 segments)
weights size          : 25912 (1 segments)
macc                  : 23874
inputs                : ['input_0_output']
outputs               : ['dense_1_output']

C-Arrays (13)
-----------------------------------------------------------------------------------------------------
c_id   name (*_array)           item/size    domain/mem-pool           c-type        fmt     comment
-----------------------------------------------------------------------------------------------------
0      input_0_output           784/3136     activations/**default**   float         float   /input 
1      conv2d_conv2d_output     392/1568     activations/**default**   float         float          
2      dense_dense_output       16/64        activations/**default**   float         float          
3      dense_output             16/64        activations/**default**   float         float          
4      dense_1_dense_output     10/40        activations/**default**   float         float          
5      dense_1_output           10/40        activations/**default**   float         float   /output
6      conv2d_conv2d_weights    18/72        weights/weights           const float   float          
7      conv2d_conv2d_bias       2/8          weights/weights           const float   float          
8      dense_dense_weights      6272/25088   weights/weights           const float   float          
9      dense_dense_bias         16/64        weights/weights           const float   float          
10     dense_1_dense_weights    160/640      weights/weights           const float   float          
11     dense_1_dense_bias       10/40        weights/weights           const float   float          
12     conv2d_conv2d_scratch0   112/448      activations/**default**   float         float          
-----------------------------------------------------------------------------------------------------

C-Layers (5)
--------------------------------------------------------------------------------------------------------------
c_id   name (*_layer)   id   layer_type          macc    rom     tensors                     shape (array id)
--------------------------------------------------------------------------------------------------------------
0      conv2d_conv2d    1    optimized_conv2d    17250   80      I: input_0_output           (1,28,28,1) (0) 
                                                                 S: conv2d_conv2d_scratch0                   
                                                                 W: conv2d_conv2d_weights    (1,2,3,3) (6)   
                                                                 W: conv2d_conv2d_bias       (1,1,1,2) (7)   
                                                                 O: conv2d_conv2d_output     (1,14,14,2) (1) 
--------------------------------------------------------------------------------------------------------------
1      dense_dense      3    dense               6288    25152   I: conv2d_conv2d_output0    (1,1,1,392) (1) 
                                                                 W: dense_dense_weights      (392,1,1,16) (8)
                                                                 W: dense_dense_bias         (1,1,1,16) (9)  
                                                                 O: dense_dense_output       (1,1,1,16) (2)  
--------------------------------------------------------------------------------------------------------------
2      dense            3    nl                  16      0       I: dense_dense_output       (1,1,1,16) (2)  
                                                                 O: dense_output             (1,1,1,16) (3)  
--------------------------------------------------------------------------------------------------------------
3      dense_1_dense    4    dense               170     680     I: dense_output             (1,1,1,16) (3)  
                                                                 W: dense_1_dense_weights    (16,1,1,10) (10)
                                                                 W: dense_1_dense_bias       (1,1,1,10) (11) 
                                                                 O: dense_1_dense_output     (1,1,1,10) (4)  
--------------------------------------------------------------------------------------------------------------
4      dense_1          4    nl                  150     0       I: dense_1_dense_output     (1,1,1,10) (4)  
                                                                 O: dense_1_output           (1,1,1,10) (5)  
--------------------------------------------------------------------------------------------------------------



Number of operations per c-layer
-----------------------------------------------------------------------------------------------------------
c_id    m_id   name (type)                        #op (type)                       #param (sparsity)      
-----------------------------------------------------------------------------------------------------------
0       1      conv2d_conv2d (optimized_conv2d)            17,250 (smul_f32_f32)               20 (0.0000)
1       3      dense_dense (dense)                          6,288 (smul_f32_f32)            6,288 (0.0000)
2       3      dense (nl)                                      16 (op_f32_f32)                            
3       4      dense_1_dense (dense)                          170 (smul_f32_f32)              170 (0.0000)
4       4      dense_1 (nl)                                   150 (op_f32_f32)                            
-----------------------------------------------------------------------------------------------------------
total                                                      23,874                           6,478 (0.0000)

  Number of operation types
  ---------------------------------------------
  smul_f32_f32              23,708       99.3%
  op_f32_f32                   166        0.7%

Complexity report (model)
----------------------------------------------------------------------------------
m_id   name            c_macc                    c_rom                     c_id  
----------------------------------------------------------------------------------
1      max_pooling2d   ||||||||||||||||  72.3%   |                  0.3%   [0]   
3      dense_dense     ||||||            26.4%   ||||||||||||||||  97.1%   [1, 2]
4      dense_1_dense   |                  1.3%   |                  2.6%   [3, 4]
----------------------------------------------------------------------------------
macc=23,874 weights=25,912 act=3,832 ram_io=0

Generated files (7)
----------------------------------------------------------------------
C:\Users\arsen\.stm32cubemx\mnist_output\mnist_config.h
C:\Users\arsen\.stm32cubemx\mnist_output\mnist.h
C:\Users\arsen\.stm32cubemx\mnist_output\mnist.c
C:\Users\arsen\.stm32cubemx\mnist_output\mnist_data_params.h
C:\Users\arsen\.stm32cubemx\mnist_output\mnist_data_params.c
C:\Users\arsen\.stm32cubemx\mnist_output\mnist_data.h
C:\Users\arsen\.stm32cubemx\mnist_output\mnist_data.c
